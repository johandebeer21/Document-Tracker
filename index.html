<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ðŸ“Œ Document Tracker</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    .fade-in {
      animation: fadeIn 0.5s ease-in-out forwards;
      opacity: 0;
    }
    @keyframes fadeIn {
      to { opacity: 1; }
    }
    .status {
      font-weight: bold;
      padding: 0.2rem 0.5rem;
      border-radius: 0.375rem;
      font-size: 0.875rem;
    }
    .Done { background-color: #4ade80; color: #064e3b; }
    ."In progress" { background-color: #facc15; color: #78350f; }
    ."Not started" { background-color: #f87171; color: #7f1d1d; }
  </style>
</head>
<body class="bg-gradient-to-br from-gray-100 to-white min-h-screen text-gray-800">
  <div class="max-w-4xl mx-auto px-4 py-10">
    <h1 class="text-3xl font-bold text-center mb-6">ðŸ“Œ Document Tracker</h1>
    <div class="bg-white shadow-md rounded-xl p-6 mb-6">
      <h2 class="text-xl font-semibold mb-2">Client Info</h2>
      <p><strong>Name:</strong> <span id="client-name"></span></p>
      <p><strong>Surname:</strong> <span id="client-surname"></span></p>
      <p><strong>Application Type:</strong> <span id="application-type"></span></p>
    </div>
    <div class="mb-4">
      <input id="search" type="text" placeholder="Search task..." class="w-full px-4 py-2 rounded border border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-400" />
    </div>
    <div id="app-list" class="grid gap-4"></div>
  </div>

  <script>
    const SHEET_URL = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vQtqULGR-HUX-Lp7ryJrR_KfuG_NeubNjYe3CvCAvDngUHsUf4VXwqZOyCDSScKadslN3JTTBp9ST3Q/pub?output=csv';
    const PROXY_URL = 'https://api.allorigins.win/raw?url=' + encodeURIComponent(SHEET_URL);

    const clientName = document.getElementById('client-name');
    const clientSurname = document.getElementById('client-surname');
    const applicationType = document.getElementById('application-type');
    const appList = document.getElementById('app-list');
    const searchInput = document.getElementById('search');

    let allTasks = [];

    function parseCSV(text) {
      const [headerLine, ...lines] = text.trim().split('\n');
      const headers = headerLine.split(',');
      return lines.map(line => {
        const data = line.split(',');
        const entry = {};
        headers.forEach((h, i) => entry[h.trim()] = data[i]?.trim() || '');
        return entry;
      });
    }

    function renderTasks(tasks) {
      appList.innerHTML = '';
      tasks.forEach((task, i) => {
        const card = document.createElement('div');
        card.className = 'fade-in bg-white p-4 rounded shadow-md transition-all duration-300';
        card.style.animationDelay = `${i * 0.05}s`;
        card.innerHTML = `
          <h3 class="text-lg font-semibold">${task['Task']}</h3>
          <p><strong>Status:</strong> <span class="status ${task['Status']}">${task['Status'] || 'Pending'}</span></p>
          <p><strong>Assignee:</strong> ${task['Assignee'] || 'â€”'}</p>
          <p><strong>Due Date:</strong> ${task['Due date'] || 'â€”'}</p>
          <p class="mt-2">${task['Description'] || ''}</p>
        `;
        appList.appendChild(card);
      });
    }

    function fetchAndDisplay() {
      fetch(PROXY_URL)
        .then(res => res.text())
        .then(csv => {
          const parsed = parseCSV(csv);
          const [clientRow, ...taskRows] = parsed;

          clientName.textContent = clientRow['Name'] || 'N/A';
          clientSurname.textContent = clientRow['Surname'] || 'N/A';
          applicationType.textContent = clientRow['Application Type'] || 'N/A';

          allTasks = taskRows.filter(row => row['Task']);
          renderTasks(allTasks);
        })
        .catch(err => {
          appList.innerHTML = '<p class="text-red-500">Failed to load data.</p>';
          console.error(err);
        });
    }

    searchInput.addEventListener('input', () => {
      const term = searchInput.value.toLowerCase();
      const filtered = allTasks.filter(t => t['Task'].toLowerCase().includes(term));
      renderTasks(filtered);
    });

    fetchAndDisplay();
  </script>
</body>
</html>









